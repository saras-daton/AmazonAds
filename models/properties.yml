version: 2
models:
  - name: SponsoredBrands_Portfolio
    description: A list of portfolios associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'fetchDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['profileId', 'portfolioId'] 
      unique_key: ['fetchDate', 'profileId', 'portfolioId']
    
  - name: SponsoredBrands_Campaign	
    description: A list of campaigns associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'fetchDate', 'data_type': date }
      cluster_by: ['fetchDate', 'campaignId'] 
      unique_key: ['fetchDate', 'campaignId']

  - name: SponsoredBrands_AdGroupsReport
    description: A list of ad groups associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['campaignId','adGroupId'] 
      unique_key: ['reportDate','campaignId','adGroupId']

  - name: SponsoredBrands_AdGroupsVideoReport
    description: A list of ad groups related to sponsored brand video associated with the account
    config: 
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['campaignId','adGroupId'] 
      unique_key: ['reportDate','campaignId','adGroupId']

  - name: SponsoredBrands_PlacementCampaignsReport
    description: A list of all the placement campaigns associated with the account.
    config:
      materialized: incremental 
      incremental_strategy: merge
      cluster_by: ['campaignId','campaignStatus'] 
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      unique_key: ['reportdate','campaignId','placement']

  - name: SponsoredBrands_SearchTermKeywordsReport
    description: A list of product search keywords report
    config: 
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['campaignId','keywordId','matchType'] 
      unique_key: ['reportDate','campaignId','keywordId','matchType','query']

  - name: SponsoredBrands_SearchTermKeywordsVideoReport
    description: A list of keywords associated with sponsored brand video
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['campaignId','keywordId','matchType'] 
      unique_key: ['reportDate','campaignId','keywordId','matchType','query']

  - name: SponsoredDisplay_Portfolio
    description: A list of portfolios associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'fetchDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['profileId', 'portfolioId'] 
      unique_key: ['fetchDate', 'profileId', 'portfolioId']

  - name: SponsoredDisplay_Campaign
    description: A list of campaigns associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'fetchDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['fetchDate', 'campaignId'] 
      unique_key: ['fetchDate', 'campaignId']

  - name: SponsoredDisplay_ProductAdsReport
    description: A list of product ads associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['CampaignId', 'adGroupID', 'asin', 'sku'] 
      unique_key: ['reportDate','CampaignId', 'adGroupID', 'asin', 'sku']

  - name: SponsoredProducts_Portfolio
    description: A list of portfolios associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'fetchDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['profileId', 'portfolioId'] 
      unique_key: ['fetchDate', 'profileId', 'portfolioId']

  - name: SponsoredProducts_Campaign
    description: A list of campaigns associated with the account
    config:
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'fetchDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['fetchDate', 'campaignId'] 
      unique_key: ['fetchDate', 'campaignId']

  - name: SponsoredProducts_PlacementCampaignsReport
    description: A list of all the placement campaigns associated with the account
    config: 
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['campaignId','placement'] 
      unique_key: ['reportDate','campaignId','placement']

  - name: SponsoredProducts_ProductAdsReport
    description: A list of product ads associated with the account
    config: 
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['campaignId', 'adGroupId','asin','sku'] 
      unique_key: ['reportDate', 'campaignId', 'adGroupId','adId']

  - name: SponsoredProducts_SearchTermKeywordReport
    description: A list of product search keywords report
    config: 
      materialized: incremental
      incremental_strategy: merge
      partition_by: { 'field': 'reportDate', 'data_type': dbt.type_timestamp() }
      cluster_by: ['campaignId','adGroupId','keywordId','matchType'] 
      unique_key: ['reportDate','campaignId','adGroupId','keywordId','matchType','query','impressions']
   